<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
<META http-equiv="Content-Type" content="text/html; charset=UTF-8">
<!--
This HTML was auto-generated from MATLAB code.
To make changes, update the MATLAB code and republish this document.
      -->
<title>CaseStudy2</title>
<meta name="generator" content="MATLAB 24.2">
<link rel="schema.DC" href="http://purl.org/dc/elements/1.1/">
<meta name="DC.date" content="2025-01-18">
<meta name="DC.source" content="CaseStudy2.m">
<style type="text/css">
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{margin:0;padding:0;border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent}body{line-height:1}ol,ul{list-style:none}blockquote,q{quotes:none}blockquote:before,blockquote:after,q:before,q:after{content:'';content:none}:focus{outine:0}ins{text-decoration:none}del{text-decoration:line-through}table{border-collapse:collapse;border-spacing:0}

html { min-height:100%; margin-bottom:1px; }
html body { height:100%; margin:0px; font-family:Arial, Helvetica, sans-serif; font-size:10px; color:#000; line-height:140%; background:#fff none; overflow-y:scroll; }
html body td { vertical-align:top; text-align:left; }

h1 { padding:0px; margin:0px 0px 25px; font-family:Arial, Helvetica, sans-serif; font-size:1.5em; color:#d55000; line-height:100%; font-weight:normal; }
h2 { padding:0px; margin:0px 0px 8px; font-family:Arial, Helvetica, sans-serif; font-size:1.2em; color:#000; font-weight:bold; line-height:140%; border-bottom:1px solid #d6d4d4; display:block; }
h3 { padding:0px; margin:0px 0px 5px; font-family:Arial, Helvetica, sans-serif; font-size:1.1em; color:#000; font-weight:bold; line-height:140%; }

a { color:#005fce; text-decoration:none; }
a:hover { color:#005fce; text-decoration:underline; }
a:visited { color:#004aa0; text-decoration:none; }

p { padding:0px; margin:0px 0px 20px; }
img { padding:0px; margin:0px 0px 20px; border:none; }
p img, pre img, tt img, li img, h1 img, h2 img { margin-bottom:0px; }

ul { padding:0px; margin:0px 0px 20px 23px; list-style:square; }
ul li { padding:0px; margin:0px 0px 7px 0px; }
ul li ul { padding:5px 0px 0px; margin:0px 0px 7px 23px; }
ul li ol li { list-style:decimal; }
ol { padding:0px; margin:0px 0px 20px 0px; list-style:decimal; }
ol li { padding:0px; margin:0px 0px 7px 23px; list-style-type:decimal; }
ol li ol { padding:5px 0px 0px; margin:0px 0px 7px 0px; }
ol li ol li { list-style-type:lower-alpha; }
ol li ul { padding-top:7px; }
ol li ul li { list-style:square; }

.content { font-size:1.2em; line-height:140%; padding: 20px; }

pre, code { font-size:12px; }
tt { font-size: 1.2em; }
pre { margin:0px 0px 20px; }
pre.codeinput { padding:10px; border:1px solid #d3d3d3; background:#f7f7f7; }
pre.codeoutput { padding:10px 11px; margin:0px 0px 20px; color:#4c4c4c; }
pre.error { color:red; }

@media print { pre.codeinput, pre.codeoutput { word-wrap:break-word; width:100%; } }

span.keyword { color:#0000FF }
span.comment { color:#228B22 }
span.string { color:#A020F0 }
span.untermstring { color:#B20000 }
span.syscmd { color:#B28C00 }
span.typesection { color:#A0522D }

.footer { width:auto; padding:10px 0px; margin:25px 0px 0px; border-top:1px dotted #878787; font-size:0.8em; line-height:140%; font-style:italic; color:#878787; text-align:left; float:none; }
.footer p { margin:0px; }
.footer a { color:#878787; }
.footer a:hover { color:#878787; text-decoration:underline; }
.footer a:visited { color:#878787; }

table th { padding:7px 5px; text-align:left; vertical-align:middle; border: 1px solid #d6d4d4; font-weight:bold; }
table td { padding:7px 5px; text-align:left; vertical-align:top; border:1px solid #d6d4d4; }





  </style>
</head>
<body>
<div class="content">
<h2>Contents</h2>
<div>
<ul>
<li>
<a href="#2">Task 1.1.</a>
</li>
<li>
<a href="#3">Task 1.2.</a>
</li>
<li>
<a href="#4">Task 2.1.</a>
</li>
<li>
<a href="#5">Task 2.2</a>
</li>
<li>
<a href="#6">Task 3.1.</a>
</li>
<li>
<a href="#7">Task 3.2.</a>
</li>
</ul>
</div>
<pre class="codeinput">
<span class="comment">% main script</span>

<span class="comment">% Task 1.</span>
</pre>
<h2 id="2">Task 1.1.</h2>
<pre class="codeinput">clear <span class="string">all</span>
close <span class="string">all</span>
clc

<span class="comment">% import data_set_1</span>

load(<span class="string">'data_set_1.mat'</span>);

<span class="comment">% linear interpolation using own function</span>

stepsize1_1 = 10;

[x_olinint, y_olinint] = linearInterpolation(x,y, stepsize1_1);

<span class="comment">% linear interpolation using matlab function</span>

x_mlinint = linspace(x(1),x(end), length(x)*stepsize1_1);
y_mlinint = interp1(x,y,x_mlinint);

figure(1)
plot(x_mlinint, y_mlinint, <span class="string">'-g'</span>, x_olinint, y_olinint, <span class="string">'--b'</span>, x,y, <span class="string">'.r'</span>, <span class="string">'MarkerSize'</span>, 10)
set(gca, <span class="string">'color'</span>, <span class="string">'w'</span>) <span class="comment">% this is only necessary if you're using the dark mode...</span>
title(<span class="string">'Linear interpolation'</span>)
legend(<span class="string">'interp1'</span>, <span class="string">'own function'</span>, <span class="string">'Original data'</span>)
xlabel(<span class="string">'x'</span>)
ylabel(<span class="string">'y'</span>)
</pre>
<img vspace="5" hspace="5" src="CaseStudy2_01.png" alt=""> <h2 id="3">Task 1.2.</h2>
<pre class="codeinput">
<span class="comment">% create test data set tx and ty</span>

tx = [0 1 3];
ty = [1 3 2];

<span class="comment">% test function with test data</span>

stepsize1_2 = 20;

[x_tpolint, y_tpolint] = polynomialInterpolation(tx, ty, stepsize1_2);

<span class="comment">% plot the results</span>

figure(2)
plot(x_tpolint, y_tpolint, <span class="string">'-b'</span>,  tx, ty, <span class="string">'.r'</span>, <span class="string">'MarkerSize'</span>, 10)
set(gca, <span class="string">'color'</span>, <span class="string">'w'</span>) <span class="comment">% this is only necessary if you're using the dark mode...</span>
title(<span class="string">'Polynomial interpolation'</span>)
legend(<span class="string">'Lagrange polynomial'</span>, <span class="string">'Test data set'</span>)
xlabel(<span class="string">'x'</span>)
ylabel(<span class="string">'y'</span>)

<span class="comment">% testing with data set 1</span>

<span class="comment">% setting specified limit</span>

xpol = x(1:1:21);
ypol = y(1:1:21);

[x_opolint, y_opolint] = polynomialInterpolation(xpol, ypol, stepsize1_2);

<span class="comment">% plot the results</span>

figure(3)
plot(x_opolint, y_opolint, <span class="string">'--b'</span>, xpol, ypol, <span class="string">'.r'</span>, <span class="string">'MarkerSize'</span>, 10)
set(gca, <span class="string">'color'</span>, <span class="string">'w'</span>) <span class="comment">% this is only necessary if you're using the dark mode...</span>
title(<span class="string">'Polynomial interpolation'</span>)
legend(<span class="string">'Lagrange polynomial'</span>, <span class="string">'data set 1'</span>)
xlim([-2 0])
ylim([-15 15])
xlabel(<span class="string">'x'</span>)
ylabel(<span class="string">'y'</span>)
</pre>
<img vspace="5" hspace="5" src="CaseStudy2_02.png" alt=""> <img vspace="5" hspace="5" src="CaseStudy2_03.png" alt=""> <h2 id="4">Task 2.1.</h2>
<pre class="codeinput">
<span class="comment">% create test_data_set</span>

tt = [0 1 2 3 4 5];
tx = [2];

<span class="keyword">for</span> i = 2:1:length(tt)

    tx(i) = tx(1)*exp(0.5 * tt(i));

<span class="keyword">end</span>

<span class="comment">% Give time dependent function</span>

sprintf(<span class="string">'X(t) = X_0 * e(μ*t) \n \nln(X(t)) = ln(X_0) + μt'</span>)

<span class="comment">% determine mu in test data set</span>

[mu, cx0, ln_x] = mu_determination(tt,tx);

<span class="comment">% calculate data with determined mu</span>

ecx1 = [cx0];

<span class="keyword">for</span> i = 2:1:length(tt)

    ecx1(i) = cx0 * exp(mu * tt(i));

<span class="keyword">end</span>

<span class="comment">% plot the results</span>

figure(4)
plot(tt, tx, <span class="string">'.b'</span>, tt, ecx1, <span class="string">'-r'</span>, <span class="string">'MarkerSize'</span>, 10)
set(gca, <span class="string">'color'</span>, <span class="string">'w'</span>) <span class="comment">% this is only necessary if you're using the dark mode...</span>
title(<span class="string">'Growth rate determination'</span>)
legend(<span class="string">'test data'</span>, <span class="string">'calculated data points'</span>)
xlabel(<span class="string">'time'</span>)
ylabel(<span class="string">'Bacterial population'</span>)

figure(5)
plot(tt, ln_x, <span class="string">'-k'</span>)
set(gca, <span class="string">'color'</span>, <span class="string">'w'</span>) <span class="comment">% this is only necessary if you're using the dark mode...</span>
title(<span class="string">'Linearized data'</span>)
legend(<span class="string">'log(test data)'</span>)
xlabel(<span class="string">'time'</span>)
ylabel(<span class="string">'log(Bacterial population)'</span>)
</pre>
<pre class="codeoutput">
ans =

    'X(t) = X_0 * e(μ*t) 
      
     ln(X(t)) = ln(X_0) + μt'

</pre>
<img vspace="5" hspace="5" src="CaseStudy2_04.png" alt=""> <img vspace="5" hspace="5" src="CaseStudy2_05.png" alt=""> <h2 id="5">Task 2.2</h2>
<pre class="codeinput">
<span class="comment">% import data_set_2</span>

load(<span class="string">'data_set_2.mat'</span>);

<span class="comment">% select exponential growth segments</span>

window = 5;
precision = 0.33;
allowed_outliers = 2;
[et, ex] = exponential_selector(time, bio_r, window, precision, allowed_outliers);

<span class="comment">% determine mu for each segment</span>

[emu1, ecx0_1, eln_x1] = mu_determination(et{1},ex{1});
[emu2, ecx0_2, eln_x2] = mu_determination(et{2},ex{2});
[emu3, ecx0_3, eln_x3] = mu_determination(et{3},ex{3});

peln_x1 = [eln_x1(1) eln_x1(end)];
pet1 = [et{1}(1) et{1}(end)];
peln_x2 = [eln_x2(1) eln_x2(end)];
pet2 = [et{2}(1) et{2}(end)];
peln_x3 = [eln_x3(1) eln_x3(end)];
pet3 = [et{3}(1) et{3}(end)];

<span class="comment">% calculate bacterial population with determined mu</span>

ecx1 = [ecx0_1];
et1 = et{1};

<span class="keyword">for</span> i = 2:1:12

    <span class="keyword">if</span> i &lt; length(et1)

        <span class="comment">% Subtracting the start time ensures the model begins from the correct point.</span>

        ecx1(i) = ecx0_1 * exp(emu1 * (et1(i) - et1(1)));

    <span class="keyword">else</span>

        <span class="comment">% values after exponential segment</span>

        i = round(et1()) + 1;
        et1(i) = i;
        ecx1(i) = ecx0_1 * exp(emu1 * (et1(i) - et1(1)));

    <span class="keyword">end</span>

<span class="keyword">end</span>

ecx2 = [ecx0_2];
et2 = et{2};

<span class="keyword">for</span> i = 2:1:12

    <span class="keyword">if</span> i &lt; length(et2)

        <span class="comment">% Subtracting the start time ensures the model begins from the correct point.</span>

        ecx2(i) = ecx0_2 * exp(emu2 * (et2(i) - et2(1)));

    <span class="keyword">else</span>

        <span class="comment">% values after exponential segment</span>

        et2(i) = i;
        ecx2(i) = ecx0_2 * exp(emu2 * (et2(i) - et2(1)));

    <span class="keyword">end</span>

<span class="keyword">end</span>

ecx3 = [ecx0_3];
et3 = et{3};

<span class="keyword">for</span> i = 2:1:12

    <span class="keyword">if</span> i &lt; length(et3)

        <span class="comment">% Subtracting the start time ensures the model begins from the correct point.</span>

        ecx3(i) = ecx0_3 * exp(emu3 * (et3(i) - et3(1)));

    <span class="keyword">else</span>

        <span class="comment">% values after exponential segment</span>

        j = i + 4;
        et3(i) = j;
        ecx3(i) = ecx0_3 * exp(emu3 * (et3(i) - et3(1)));

        <span class="keyword">if</span> j == 12

            <span class="keyword">break</span>

        <span class="keyword">end</span>

    <span class="keyword">end</span>

<span class="keyword">end</span>

<span class="comment">% plot the results</span>

figure(6)
plot(time, bio_r, <span class="string">'.k'</span>, et{1}, ex{1}, <span class="string">'-g'</span>, et{2}, ex{2}, <span class="string">'-c'</span>, et{3}, ex{3}, <span class="string">'-b'</span>, <span class="keyword">...</span>
    et1, ecx1, <span class="string">'--g'</span>, et2, ecx2, <span class="string">'--c'</span>,et3, ecx3, <span class="string">'--b'</span>)
set(gca, <span class="string">'color'</span>, <span class="string">'w'</span>) <span class="comment">% this is only necessary if you're using the dark mode...</span>
title(<span class="string">'Bacterial growth'</span>)
ylim([0 5])
legend(<span class="string">'data set 2'</span>, <span class="string">'exponential segment 1'</span>, <span class="string">'exponential segment 2'</span>, <span class="string">'exponential segment 3'</span>, <span class="keyword">...</span>
    <span class="string">'simulated exponential growth in segment 1'</span>, <span class="string">'simulated exponential growth in segment 2'</span>, <span class="string">'simulated exponential growth in segment 3'</span>)
xlabel(<span class="string">'time'</span>)
ylabel(<span class="string">'Bacterial population'</span>)

figure(7)
plot(pet1, peln_x1, <span class="string">'-g'</span>, pet2, peln_x2, <span class="string">'-c'</span>, pet3, peln_x3, <span class="string">'-b'</span>)
set(gca, <span class="string">'color'</span>, <span class="string">'w'</span>) <span class="comment">% this is only necessary if you're using the dark mode...</span>
title(<span class="string">'Linearized data'</span>)
legend(<span class="string">'Segment 1'</span>, <span class="string">'Segment 2'</span>, <span class="string">'Segment 3'</span>)
xlabel(<span class="string">'time'</span>)
ylabel(<span class="string">'log(Bacterial population)'</span>)
</pre>
<img vspace="5" hspace="5" src="CaseStudy2_06.png" alt=""> <img vspace="5" hspace="5" src="CaseStudy2_07.png" alt=""> <h2 id="6">Task 3.1.</h2>
<pre class="codeinput">
<span class="comment">% study the influence of k</span>

<span class="keyword">for</span> k = 1:1:4

    [Ts(k,:), Xs(k,:)] = smoother(time, bio_r, k);

<span class="keyword">end</span>

figure(8)
plot(time, bio_r, <span class="string">'.k'</span>, Ts(1,:), Xs(1,:), <span class="string">'-c'</span>, Ts(2,:), Xs(2,:), <span class="string">'-g'</span>, <span class="keyword">...</span>
    Ts(3,:), Xs(3,:), <span class="string">'-y'</span>, Ts(4,:), Xs(4,:), <span class="string">'-r'</span>)
set(gca, <span class="string">'color'</span>, <span class="string">'w'</span>) <span class="comment">% this is only necessary if you're using the dark mode...</span>
title(<span class="string">'Smoothed data fit'</span>)
legend(<span class="string">'Original data set'</span>, <span class="string">'k = 1'</span>, <span class="string">'k = 2'</span>, <span class="string">'k = 3'</span>, <span class="string">'k = 4'</span>)
xlabel(<span class="string">'time'</span>)
ylabel(<span class="string">'Bacterial population'</span>)
</pre>
<img vspace="5" hspace="5" src="CaseStudy2_08.png" alt=""> <h2 id="7">Task 3.2.</h2>
<pre class="codeinput">
<span class="comment">% calculate first derivative</span>

<span class="keyword">for</span> k = 1:1:4

    fbar_y(k,:) = differentiator(Ts(k,:), Xs(k,:));

<span class="keyword">end</span>

figure(9)
plot(Ts(1,:), Xs(1,:), <span class="string">'-c'</span>, Ts(2,:), Xs(2,:), <span class="string">'-g'</span>, Ts(3,:), Xs(3,:), <span class="string">'-y'</span>, Ts(4,:), Xs(4,:), <span class="string">'-r'</span>, <span class="keyword">...</span>
    Ts(1,:), fbar_y(1,:), <span class="string">'.c'</span>, Ts(2,:), fbar_y(2,:), <span class="string">'.g'</span>, Ts(3,:), fbar_y(3,:), <span class="string">'.y'</span>, Ts(4,:), fbar_y(4,:), <span class="string">'.r'</span>)
set(gca, <span class="string">'color'</span>, <span class="string">'w'</span>) <span class="comment">% this is only necessary if you're using the dark mode...</span>
title(<span class="string">'Numerical differentiation'</span>)
legend(<span class="string">'smoothed data fit, k = 1'</span>, <span class="string">'smoothed data fit, k = 2'</span>, <span class="string">'smoothed data fit, k = 3'</span>, <span class="string">'smoothed data fit, k = 4'</span>, <span class="keyword">...</span>
    <span class="string">'numeric differentiation, k = 1'</span>, <span class="string">'numeric differentiation, k = 2'</span>, <span class="string">'numeric differentiation, k = 3'</span>, <span class="string">'numeric differentiation, k = 4'</span>)
xlabel(<span class="string">'time'</span>)
ylabel(<span class="string">'Bacterial population'</span>)
</pre>
<img vspace="5" hspace="5" src="CaseStudy2_09.png" alt=""> <p class="footer">
<br>
<a href="https://www.mathworks.com/products/matlab/">Published with MATLAB&reg; R2024b</a>
<br>
</p>
</div>
<!--
##### SOURCE BEGIN #####
% main script

% Task 1.

%% Task 1.1.

clear all
close all
clc

% import data_set_1

load('data_set_1.mat');

% linear interpolation using own function

stepsize1_1 = 10;

[x_olinint, y_olinint] = linearInterpolation(x,y, stepsize1_1);

% linear interpolation using matlab function 

x_mlinint = linspace(x(1),x(end), length(x)*stepsize1_1);
y_mlinint = interp1(x,y,x_mlinint);

figure(1)
plot(x_mlinint, y_mlinint, '-g', x_olinint, y_olinint, 'REPLACE_WITH_DASH_DASHb', x,y, '.r', 'MarkerSize', 10)
set(gca, 'color', 'w') % this is only necessary if you're using the dark mode...
title('Linear interpolation')
legend('interp1', 'own function', 'Original data')
xlabel('x')
ylabel('y')

%% Task 1.2.

% create test data set tx and ty

tx = [0 1 3];
ty = [1 3 2];

% test function with test data

stepsize1_2 = 20;

[x_tpolint, y_tpolint] = polynomialInterpolation(tx, ty, stepsize1_2);

% plot the results

figure(2)
plot(x_tpolint, y_tpolint, '-b',  tx, ty, '.r', 'MarkerSize', 10)
set(gca, 'color', 'w') % this is only necessary if you're using the dark mode...
title('Polynomial interpolation')
legend('Lagrange polynomial', 'Test data set')
xlabel('x')
ylabel('y')

% testing with data set 1

% setting specified limit

xpol = x(1:1:21);
ypol = y(1:1:21);

[x_opolint, y_opolint] = polynomialInterpolation(xpol, ypol, stepsize1_2);

% plot the results

figure(3)
plot(x_opolint, y_opolint, 'REPLACE_WITH_DASH_DASHb', xpol, ypol, '.r', 'MarkerSize', 10)
set(gca, 'color', 'w') % this is only necessary if you're using the dark mode...
title('Polynomial interpolation')
legend('Lagrange polynomial', 'data set 1')
xlim([-2 0])
ylim([-15 15])
xlabel('x')
ylabel('y')

%% Task 2.1.

% create test_data_set

tt = [0 1 2 3 4 5];
tx = [2];

for i = 2:1:length(tt)
    
    tx(i) = tx(1)*exp(0.5 * tt(i));

end

% Give time dependent function

sprintf('X(t) = X_0 * e(μ*t) \n \nln(X(t)) = ln(X_0) + μt')

% determine mu in test data set

[mu, cx0, ln_x] = mu_determination(tt,tx);

% calculate data with determined mu

ecx1 = [cx0];

for i = 2:1:length(tt)
    
    ecx1(i) = cx0 * exp(mu * tt(i));

end

% plot the results

figure(4)
plot(tt, tx, '.b', tt, ecx1, '-r', 'MarkerSize', 10)
set(gca, 'color', 'w') % this is only necessary if you're using the dark mode...
title('Growth rate determination')
legend('test data', 'calculated data points')
xlabel('time')
ylabel('Bacterial population')

figure(5)
plot(tt, ln_x, '-k')
set(gca, 'color', 'w') % this is only necessary if you're using the dark mode...
title('Linearized data')
legend('log(test data)')
xlabel('time')
ylabel('log(Bacterial population)')

%% Task 2.2

% import data_set_2

load('data_set_2.mat');

% select exponential growth segments

window = 5;
precision = 0.33;
allowed_outliers = 2;
[et, ex] = exponential_selector(time, bio_r, window, precision, allowed_outliers);

% determine mu for each segment

[emu1, ecx0_1, eln_x1] = mu_determination(et{1},ex{1});
[emu2, ecx0_2, eln_x2] = mu_determination(et{2},ex{2});
[emu3, ecx0_3, eln_x3] = mu_determination(et{3},ex{3});

peln_x1 = [eln_x1(1) eln_x1(end)];
pet1 = [et{1}(1) et{1}(end)];
peln_x2 = [eln_x2(1) eln_x2(end)];
pet2 = [et{2}(1) et{2}(end)];
peln_x3 = [eln_x3(1) eln_x3(end)];
pet3 = [et{3}(1) et{3}(end)];

% calculate bacterial population with determined mu

ecx1 = [ecx0_1];
et1 = et{1};

for i = 2:1:12
    
    if i < length(et1)

        % Subtracting the start time ensures the model begins from the correct point.

        ecx1(i) = ecx0_1 * exp(emu1 * (et1(i) - et1(1)));

    else
        
        % values after exponential segment
        
        i = round(et1()) + 1;
        et1(i) = i;
        ecx1(i) = ecx0_1 * exp(emu1 * (et1(i) - et1(1)));

    end
       
end

ecx2 = [ecx0_2];
et2 = et{2};

for i = 2:1:12

    if i < length(et2)
    
        % Subtracting the start time ensures the model begins from the correct point.

        ecx2(i) = ecx0_2 * exp(emu2 * (et2(i) - et2(1)));

    else
        
        % values after exponential segment

        et2(i) = i;
        ecx2(i) = ecx0_2 * exp(emu2 * (et2(i) - et2(1)));

    end

end

ecx3 = [ecx0_3];
et3 = et{3};

for i = 2:1:12

    if i < length(et3)

        % Subtracting the start time ensures the model begins from the correct point.
    
        ecx3(i) = ecx0_3 * exp(emu3 * (et3(i) - et3(1)));
    
    else
        
        % values after exponential segment
        
        j = i + 4;
        et3(i) = j;
        ecx3(i) = ecx0_3 * exp(emu3 * (et3(i) - et3(1)));

        if j == 12

            break

        end

    end

end

% plot the results

figure(6)
plot(time, bio_r, '.k', et{1}, ex{1}, '-g', et{2}, ex{2}, '-c', et{3}, ex{3}, '-b', ...
    et1, ecx1, 'REPLACE_WITH_DASH_DASHg', et2, ecx2, 'REPLACE_WITH_DASH_DASHc',et3, ecx3, 'REPLACE_WITH_DASH_DASHb')
set(gca, 'color', 'w') % this is only necessary if you're using the dark mode...
title('Bacterial growth')
ylim([0 5])
legend('data set 2', 'exponential segment 1', 'exponential segment 2', 'exponential segment 3', ...
    'simulated exponential growth in segment 1', 'simulated exponential growth in segment 2', 'simulated exponential growth in segment 3')
xlabel('time')
ylabel('Bacterial population')

figure(7)
plot(pet1, peln_x1, '-g', pet2, peln_x2, '-c', pet3, peln_x3, '-b')
set(gca, 'color', 'w') % this is only necessary if you're using the dark mode...
title('Linearized data')
legend('Segment 1', 'Segment 2', 'Segment 3')
xlabel('time')
ylabel('log(Bacterial population)')

%% Task 3.1.

% study the influence of k

for k = 1:1:4

    [Ts(k,:), Xs(k,:)] = smoother(time, bio_r, k);

end

figure(8)
plot(time, bio_r, '.k', Ts(1,:), Xs(1,:), '-c', Ts(2,:), Xs(2,:), '-g', ...
    Ts(3,:), Xs(3,:), '-y', Ts(4,:), Xs(4,:), '-r')
set(gca, 'color', 'w') % this is only necessary if you're using the dark mode...
title('Smoothed data fit')
legend('Original data set', 'k = 1', 'k = 2', 'k = 3', 'k = 4')
xlabel('time')
ylabel('Bacterial population')

%% Task 3.2.

% calculate first derivative

for k = 1:1:4
    
    fbar_y(k,:) = differentiator(Ts(k,:), Xs(k,:));

end

figure(9)
plot(Ts(1,:), Xs(1,:), '-c', Ts(2,:), Xs(2,:), '-g', Ts(3,:), Xs(3,:), '-y', Ts(4,:), Xs(4,:), '-r', ...
    Ts(1,:), fbar_y(1,:), '.c', Ts(2,:), fbar_y(2,:), '.g', Ts(3,:), fbar_y(3,:), '.y', Ts(4,:), fbar_y(4,:), '.r')
set(gca, 'color', 'w') % this is only necessary if you're using the dark mode...
title('Numerical differentiation')
legend('smoothed data fit, k = 1', 'smoothed data fit, k = 2', 'smoothed data fit, k = 3', 'smoothed data fit, k = 4', ...
    'numeric differentiation, k = 1', 'numeric differentiation, k = 2', 'numeric differentiation, k = 3', 'numeric differentiation, k = 4')
xlabel('time')
ylabel('Bacterial population')
##### SOURCE END #####
-->
</body>
</html>
